exports.handler = function(context, event, callback) {
  const twiml = new Twilio.twiml.MessagingResponse();
  const message = (event.Body || "").toLowerCase().trim();

  // MAIN MENU
  if (message === 'hello' || message === 'hi' || message === 'start' || message === 'hey' || 
      message.startsWith('hello ') || message.startsWith('hi ') || message.includes('jai jinendra')) {
    twiml.message(
      "ğŸ’‘ *Deshna & Mehul* âœ¨ #OfficiallyMaD\n25-27 Nov 2025 | Nathdwara\n\n1ï¸âƒ£ Itinerary\n2ï¸âƒ£ Contact Info\n3ï¸âƒ£ Wishes\n4ï¸âƒ£ Website\n\nğŸ’¬ Reply *1-4* or *HI*"
    );

  // SCHEDULE SUMMARY
  } else if (message === '1' || message.includes('itinerary') || message.includes('schedule')) {
    twiml.message(
      "ğŸ“… *Wedding Schedule*\n\n25 Nov (Tue) - Mehendi & Sangeet\n26 Nov (Wed) - Haldi & Wedding\n27 Nov (Thu) - Breakfast & Departure\n\nğŸ’¬ Reply *25/26/27* for details or *ALL*"
    );

  // FULL SCHEDULE
  } else if (message === 'all') {
    twiml.message(
      "ğŸ“œ *Complete Schedule*\n\nğŸ“† 25 Nov (Tue)\nğŸ“ Radisson Blu (Miraj Stadium), Nathdwara\nğŸ—ºï¸ https://maps.app.goo.gl/WUj63rss4wiT8wGS7\n\n8am Breakfast (ADD, 3rd Floor)\n10:30am Mayra (Bride Side)\nğŸ“ Banquet Hall, 4th Floor\n12:30pm Mehendi + Lunch\nğŸ“ Banquet Hall, 4th Floor\nğŸ¨ Boho Banjara - Green, Yellow, Red, Orange, Blue\n\n7pm Sangeet + Dinner\nğŸ“ Miraj Arena, North End\nğŸ¨ Glitz & Glam - Black, Navy, Silver, Royal Blue\n\nğŸ“† 26 Nov (Wed)\nğŸ“ Radisson Blu (Miraj Stadium), Nathdwara\nğŸ—ºï¸ https://maps.app.goo.gl/WUj63rss4wiT8wGS7\n\n8am Breakfast (ADD, 3rd Floor)\n12pm Haldi + Lunch\nğŸ“ Miraj Pavilion, North End\nğŸ¨ High Street - Pink, Yellow, Orange, Purple\n\n6:30pm Baraat Assemble & Sehra Bandi (Lobby)\n7pm Baraat Procession\n8:01pm Varmala & Reception + Dinner\nğŸ“ Miraj Arena, North End\nMidnight Pheras\nğŸ“ Patio, South End\nğŸ¨ Rajwada Royal - Gold, Red, Cream, Hot Pink, Maroon\n\nğŸ“† 27 Nov (Thu)\n8am Breakfast (ADD, 3rd)\n\nâ˜• Refreshments 24Ã—7 @ ADD, 3rd Floor\nğŸ’¬ *HI*"
    );

  // NOV 25
  } else if (message === '25' || message.includes('tuesday') || message.includes('tue')) {
    twiml.message(
      "ğŸ“… *Tue 25 Nov*\nğŸ“ Radisson Blu (Miraj Stadium), Nathdwara\nğŸ—ºï¸ https://maps.app.goo.gl/WUj63rss4wiT8wGS7\n\nâ° 8:00am â€” Breakfast\nğŸ“ ADD, 3rd Floor\n\nâ° 10:30am â€” Mayra (Bride Side)\nğŸ“ Banquet Hall, 4th Floor\n\nâ° 12:30pm â€” Mehendi + Lunch\nğŸ“ Banquet Hall, 4th Floor\nğŸ¨ *Boho Banjara*\nBurst of color, playful layers, boho accessories\nğŸ¨ Colors: Green, Yellow, Red, Orange, Blue\n\nâ° 7:00pm â€” Sangeet + Dinner\nğŸ“ Miraj Arena, North End\nğŸ¨ *Glitz & Glam*\nSparkle & shine in blues and metallics\nğŸ¨ Colors: Black, Navy Blue, Dark Blue, Silver, Royal Blue\n\n_Dinner before sunset available at venue_\nâ˜• Refreshments 24Ã—7 @ ADD, 3rd Floor\n\nğŸ’¬ *HI*"
    );

  // NOV 26
  } else if (message === '26' || message.includes('wednesday') || message.includes('wed')) {
    twiml.message(
      "ğŸ“… *Wed 26 Nov*\nğŸ“ Radisson Blu (Miraj Stadium), Nathdwara\nğŸ—ºï¸ https://maps.app.goo.gl/WUj63rss4wiT8wGS7\n\nâ° 8:00am â€” Breakfast\nğŸ“ ADD, 3rd Floor\n\nâ° 12:00pm â€” Haldi Carnival + Lunch\nğŸ“ Miraj Pavilion, North End\nğŸ¨ *High Street Fashion*\nTrendy pastels with chic cuts, fairy-tale twist\nğŸ¨ Colors: Pink, Yellow, Orange, Purple, Light Green\n\nâ° 6:30pm â€” Baraat Assemble & Sehra Bandi\nğŸ“ Lobby\nâ° 7:00pm â€” Baraat Procession\n\nâ° 8:01pm â€” Varmala & Reception + Dinner\nğŸ“ Miraj Arena, North End\nâ° Midnight â€” Pheras\nğŸ“ Patio, South End\nğŸ¨ *Rajwada Royal*\nMost royal look - rich colors & grand traditional wear\nğŸ¨ Colors: Gold, Red, Cream, Hot Pink, Maroon\n\n_Dinner before sunset available at venue_\nâ˜• Refreshments 24Ã—7 @ ADD, 3rd Floor\n\nğŸ’¬ *HI*"
    );

  // NOV 27
  } else if (message === '27' || message.includes('thursday') || message.includes('thu')) {
    twiml.message(
      "ğŸ“… *Thu 27 Nov*\nğŸ“ Radisson Blu (Miraj Stadium), Nathdwara\nğŸ—ºï¸ https://maps.app.goo.gl/WUj63rss4wiT8wGS7\n\nâ° 8:00am â€” Breakfast\nğŸ“ ADD, 3rd Floor\n\nâ˜• Refreshments 24Ã—7 @ ADD, 3rd Floor\n\nğŸ’• Thanks for celebrating with us!\nğŸ’¬ *HI*"
    );

  // CONTACT INFORMATION MENU
  } else if (message === '2') {
    twiml.message(
      "ğŸ“ *Contact Information*\n\nğŸ¨ Hotels:\nRADISSON | SAHI | GOPAL | SSHUBH\n\nğŸ“ Or reply VENUE for main venue details\n\nğŸ’¬ Type hotel name or VENUE"
    );

  // RADISSON BLU
  } else if (message.includes('radisson') || message.includes('blu')) {
    twiml.message(
      "ğŸ¨ *Radisson Blu*\nğŸ“ +91 74250 86947\nReception: 9 | Housekeeping: 6\nğŸ“ https://maps.app.goo.gl/WUj63rss4wiT8wGS7\n\nğŸ’¬ *HI*"
    );

  // SAHI HOTEL
  } else if (message.includes('sahi')) {
    twiml.message(
      "ğŸ¨ *Sahi Hotel*\nğŸ“ 7073772203\nReception/Housekeeping: 9\n\nğŸ’¬ *HI*"
    );

  // GOPAL DARSHAN
  } else if (message.includes('gopal')) {
    twiml.message(
      "ğŸ¨ *Hotel Gopal Darshan*\nğŸ“ 7737923212\nReception/Housekeeping: 9\n\nğŸ’¬ *HI*"
    );

  // SSHUBH HOTEL
  } else if (message.includes('shubh') || message.includes('sshubh')) {
    twiml.message(
      "ğŸ¨ *Sshubh Hotel*\nğŸ“ 7726924686\nReception/Housekeeping: 9\n\nğŸ’¬ *HI*"
    );

  // VENUE ONLY
  } else if (message.includes('venue') || message.includes('direction')) {
    twiml.message(
      "ğŸ“ *Main Venue*\nRadisson Blu (Miraj Stadium)\nNathdwara\n\nğŸ—ºï¸ https://maps.app.goo.gl/WUj63rss4wiT8wGS7\n\nğŸ’¬ *HI*"
    );

  // GENERIC CONTACT/HOTEL/HELPDESK - Must come AFTER specific hotels
  } else if (message.includes('contact') || message.includes('hotel') || message.includes('helpdesk') || message.includes('location')) {
    twiml.message(
      "ğŸ“ *Contact Information*\n\nğŸ¨ Hotels:\nRADISSON | SAHI | GOPAL | SSHUBH\n\nğŸ“ Main Venue:\nRadisson Blu (Miraj Stadium)\nNathdwara\nğŸ—ºï¸ https://maps.app.goo.gl/WUj63rss4wiT8wGS7\n\nğŸ’¬ Type hotel name or *HI*"
    );

  // SEND WISHES
  } else if (message === '3' || message.includes('wish') || message.includes('message')) {
    twiml.message(
      "ğŸ’Œ *Send Your Wishes*\nhttps://docs.google.com/forms/d/e/1FAIpQLSdx8DaeYRaVfbhN6YY4rhOCz8PszjdJ2eoIInD9EqA1u8KtcA/viewform\n_(Compiled into keepsake)_\n\nğŸ’¬ *HI*"
    );

  // WEBSITE
  } else if (message === '4' || message.includes('website') || message.includes('web')) {
    twiml.message(
      "ğŸŒ *Wedding Website*\nPhotos, story, travel & gifts\nğŸ”— https://officiallymad.fun\n\nğŸ’¬ *HI*"
    );

  // THANKS
  } else if (message.includes('thank')) {
    twiml.message("ğŸ’• Welcome! Enjoy! #OfficiallyMaD\nğŸ’¬ *HI*");

  // FALLBACK - OPTIMIZED (shorter message = lower cost)
  } else {
    twiml.message("Reply: 1-Itinerary 2-Contact 3-Wishes 4-Website or *HI*");
  }

  callback(null, twiml);
};
